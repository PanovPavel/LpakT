<Window x:Class="LpakViewClient.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:modelView="clr-namespace:LpakViewClient.ModelView"
        xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
        mc:Ignorable="d"
        Title="MainWindow" Height="650" Width="1200">
    <!--<Window.DataContext>
        <modelView:CustomerViewModel></modelView:CustomerViewModel>
    </Window.DataContext>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="1*" />
            <ColumnDefinition Width="2*" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"></RowDefinition>
            <RowDefinition Height="50"></RowDefinition>
            <RowDefinition Height="150"></RowDefinition>
        </Grid.RowDefinitions>
        <DataGrid Grid.Row="0" Grid.Column="0" SelectionMode="Single" ItemsSource="{Binding Customers}"
                  SelectedItem="{Binding SelectedCustomer}" AutoGenerateColumns="False">
            <DataGrid.Columns>
                <DataGridTextColumn IsReadOnly="True" Header="Id" Binding="{Binding CustomerId}" />
                <DataGridTextColumn IsReadOnly="True" Header="Name" Binding="{Binding Name}" />
                <DataGridTextColumn IsReadOnly="True" Header="TaxNumber" Binding="{Binding TaxNumber}" />
                <DataGridTextColumn IsReadOnly="True" Header="FieldOfBusiness" Binding="{Binding FieldOfBusiness.Name}" />
                <DataGridTextColumn IsReadOnly="True" Header="Comment" Binding="{Binding Comment}" />
            </DataGrid.Columns>
        </DataGrid>
        <Grid Grid.Row="1" Grid.Column="0">
            <StackPanel Orientation="Horizontal" VerticalAlignment="Bottom">
                <Button Height="50" Command="{Binding UpdateCustomerOpenWindow}"
                        CommandParameter="{Binding SelectedCustomer}">
                    Изменить
                </Button>
                <Button Height="50" Command="{Binding RemoveSelectedCustomer}"
                        CommandParameter="{Binding SelectedCustomer}">
                    Удалить объект
                </Button>
                <Button Height="50" Command="{Binding AddNewCustomerOpenWindow}" CommandParameter="{Binding}">Добавить объект</Button>
            </StackPanel>
        </Grid>
        <Grid Grid.Row="2" Grid.Column="0">
            <TextBox Text="{Binding SelectedCustomer.Comment, UpdateSourceTrigger=LostFocus}"> </TextBox>
        </Grid>
        
        <Grid Grid.Column="1">
            <DataGrid Grid.Row="0" Grid.Column="0" SelectionMode="Single" ItemsSource="{Binding SelectedCustomer.Orders}"
                      SelectedItem="{Binding SelectedOrder}" AutoGenerateColumns="False">
                <DataGrid.Columns>
                    <DataGridTextColumn  Header="OrderId" Binding="{Binding Id}" />
                    <DataGridTextColumn  Header="StatusOrder" Binding="{Binding Status.Name}" />
                    <DataGridTextColumn IsReadOnly="True" Header="DataCreated" Binding="{Binding DateTimeCreatedOrder}" />
                    <DataGridTextColumn IsReadOnly="True" Header="NameWork" Binding="{Binding NameOfWork}" />
                    <DataGridTextColumn IsReadOnly="True" Header="DescriptionWork" Binding="{Binding DescriptionOfWork}" />
                </DataGrid.Columns>
            </DataGrid>
        </Grid>
        <Button Grid.Column="1" Command="{Binding RemoveSelectedOrder}" CommandParameter="{Binding SelectedOrder}"  Grid.Row="1" >sad</Button>
    </Grid>-->
    
     <Window.DataContext>
        <modelView:CustomerViewModel></modelView:CustomerViewModel>
    </Window.DataContext>

    <Window.Resources>
        <ContextMenu x:Key="RowContextMenu">
            <MenuItem Header="Изменить" Command="{Binding UpdateCustomerOpenWindow}"
                      CommandParameter="{Binding }" />
            <MenuItem Header="Удалить объект" Command="{Binding RemoveSelectedCustomer}"
                      CommandParameter="{Binding SelectedCustomer}" />
            <MenuItem Header="Добавить объект" Command="{Binding AddNewCustomerOpenWindow}"
                      CommandParameter="{Binding}" />
        </ContextMenu>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*" />
            <ColumnDefinition Width="1*" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"></RowDefinition>
            <RowDefinition Height="150"></RowDefinition>
        </Grid.RowDefinitions>
        
        <DataGrid Grid.Row="0" Grid.Column="0" SelectionMode="Single" ItemsSource="{Binding Customers}"
                  SelectedItem="{Binding SelectedCustomer}" AutoGenerateColumns="False"
                  ContextMenu="{StaticResource RowContextMenu}" >
            <DataGrid.Columns>
                <DataGridTextColumn IsReadOnly="True" Header="Id" Binding="{Binding CustomerId}" />
                <DataGridTextColumn IsReadOnly="True" Header="Name" Binding="{Binding Name}" />
                <DataGridTextColumn IsReadOnly="True" Header="TaxNumber" Binding="{Binding TaxNumber}" />
                <DataGridTextColumn IsReadOnly="True" Header="FieldOfBusiness" Binding="{Binding FieldOfBusiness.Name}" />
                <DataGridTextColumn IsReadOnly="True" Header="Comment" Binding="{Binding Comment}" />
            </DataGrid.Columns>
        </DataGrid>
        
        <Grid Grid.Row="1" Grid.Column="0">
            <TextBox Text="{Binding SelectedCustomer.Comment, UpdateSourceTrigger=LostFocus}">
                <b:Interaction.Triggers>
                    <b:EventTrigger EventName="LostFocus">
                        <b:InvokeCommandAction 
                            Command="{Binding UpdateCustomer}"
                            CommandParameter="{Binding SelectedCustomer}" />
                    </b:EventTrigger>
                </b:Interaction.Triggers>
            </TextBox>
        </Grid>
        
        <Grid Grid.Column="1">
            <DataGrid Grid.Row="0" Grid.Column="0" SelectionMode="Single" ItemsSource="{Binding SelectedCustomer.Orders}"
                      SelectedItem="{Binding SelectedOrder}" AutoGenerateColumns="False">
                <DataGrid.Columns>
                    <DataGridTextColumn  Header="OrderId" Binding="{Binding Id}" />
                    <DataGridTextColumn  Header="StatusOrder" Binding="{Binding Status.Name}" />
                    <DataGridTextColumn IsReadOnly="True" Header="DataCreated" Binding="{Binding DateTimeCreatedOrder}" />
                    <DataGridTextColumn IsReadOnly="True" Header="NameWork" Binding="{Binding NameOfWork}" />
                    <DataGridTextColumn IsReadOnly="True" Header="DescriptionWork" Binding="{Binding DescriptionOfWork}" />
                </DataGrid.Columns>
            </DataGrid>
        </Grid>
        <Button Grid.Row="1" Height="50" VerticalAlignment="Bottom" Grid.Column="1" Command="{Binding RemoveSelectedOrder}" CommandParameter="{Binding SelectedOrder}"   >sad</Button>
    </Grid>
</Window>